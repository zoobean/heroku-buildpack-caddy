[
  {
    "id": "100001",
    "phase": 2,
    "pattern": "\\.php$",
    "targets": [
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block PHP file access attempts - migrated from Rack Attack"
  },
  {
    "id": "100002",
    "phase": 2,
    "pattern": "(?i)^/(wp-admin|phpmyadmin|xmlrpc\\.php|dbadmin|myadmin|\\.env)",
    "targets": [
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block penetration testing probes - migrated from Rack Attack"
  },
  {
    "id": "100003",
    "phase": 2,
    "pattern": "(?i)(jndi:ldap|jndi:rmi|jndi:dns|\\${jndi:|%24%7Bjndi:)",
    "targets": [
      "HEADERS:User-Agent",
      "HEADERS:Referer",
      "HEADERS:Content-Type",
      "HEADERS:Accept",
      "HEADERS:X-Forwarded-For",
      "HEADERS:Authorization",
      "ARGS"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block Log4j injection attempts - migrated from Rack Attack"
  },
  {
    "id": "100004",
    "phase": 2,
    "pattern": "(?i)(/etc/passwd|/etc/shadow|/proc/|UNION SELECT|UNION%20SELECT|' OR 1=1|%27%20OR%201=1|DROP TABLE|DROP%20TABLE|SELECT \\* FROM|SELECT%20\\*%20FROM)",
    "targets": [
      "ARGS",
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block system file access and SQL injection attempts - migrated from Rack Attack"
  },
  {
    "id": "100005",
    "phase": 2,
    "pattern": "(?i)(; cat |\\|cat |&cat |\\$\\(|`)",
    "targets": [
      "ARGS",
      "HEADERS:User-Agent",
      "HEADERS:Referer"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block command injection attempts - migrated from Rack Attack"
  },
  {
    "id": "100006",
    "phase": 2,
    "pattern": "(?i)(opensymphony|\\(\\) \\{ :; \\}|<!ENTITY|SYSTEM)",
    "targets": [
      "HEADERS:Content-Type",
      "HEADERS:Accept",
      "HEADERS:User-Agent",
      "HEADERS:Referer",
      "HEADERS:Cookie"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block Struts, Shellshock and XXE attacks - migrated from Rack Attack"
  },
  {
    "id": "100007",
    "phase": 2,
    "pattern": "(?i)(\\.\\./)|(\\.\\.\\\\)|file://|php://|data://|expect://",
    "targets": [
      "ARGS",
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block file inclusion attempts - migrated from Rack Attack"
  },
  {
    "id": "100008",
    "phase": 2,
    "pattern": "(?i)(system\\(|exec\\(|shell_exec\\(|passthru\\(|eval\\(|base64_decode\\()",
    "targets": [
      "ARGS"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block remote code execution attempts - migrated from Rack Attack"
  },
  {
    "id": "100009",
    "phase": 2,
    "pattern": "(?i)(<!--#exec|%3C%21--%23exec|<!--#include|%3C%21--%23include|<!entity|%3C%21entity|<!doctype.*entity|%3C%21doctype.*entity)",
    "targets": [
      "ARGS"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block server-side includes and XXE injection - migrated from Rack Attack"
  },
  {
    "id": "100010",
    "phase": 2,
    "pattern": "(?i)(\\(cn=|\\(uid=|\\(objectclass=)",
    "targets": [
      "ARGS"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block LDAP injection attempts - migrated from Rack Attack"
  },
  {
    "id": "100011",
    "phase": 2,
    "pattern": "(?i)(\\$ne|\\$gt|\\$lt|\\$regex|\\$where)",
    "targets": [
      "ARGS"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block NoSQL injection attempts - migrated from Rack Attack"
  },
  {
    "id": "100012",
    "phase": 2,
    "pattern": "(?i)(xpath|//user|//password)",
    "targets": [
      "ARGS"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block XPath injection attempts - migrated from Rack Attack"
  },
  {
    "id": "100013",
    "phase": 2,
    "pattern": "(?i)(\\{\\{.*\\}\\}|\\{%.*%\\})",
    "targets": [
      "ARGS"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block template injection attempts - migrated from Rack Attack"
  },
  {
    "id": "100014",
    "phase": 2,
    "pattern": "(?i)(whoami|uname|netstat|ifconfig|ping.*[;&|])",
    "targets": [
      "ARGS"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block OS command attempts - migrated from Rack Attack"
  },
  {
    "id": "100015",
    "phase": 2,
    "pattern": "(?i)(scanner|bot.*(scan|vuln|exploit|test)|python-requests.*admin|curl.*(php|admin|wp-))",
    "targets": [
      "HEADERS:User-Agent"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block suspicious scanner patterns - migrated from Rack Attack"
  },
  {
    "id": "100016",
    "phase": 2,
    "pattern": "(?i)/(etc/passwd|etc/shadow|etc/hosts|etc/resolv\\.conf|proc/self/environ|proc/version|proc/cmdline|proc/meminfo|proc/cpuinfo|boot\\.ini|windows/system32)",
    "targets": [
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block system file access attempts via path - migrated from Rack Attack"
  },
  {
    "id": "100017",
    "phase": 2,
    "pattern": "(?i)/(wp-admin|wp-includes|wp-content|wp-json|phpmyadmin|phpMyAdmin|pma|dbadmin|myadmin|mysql-admin|websql|sqladmin|database|db_admin)",
    "targets": [
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block database admin panel access attempts - migrated from Rack Attack"
  },
  {
    "id": "100018",
    "phase": 2,
    "pattern": "(?i)/(administrator|cpanel|whm|plesk|webmin|usermin|directadmin|vesta|froxlor|ispconfig|kloxo|sentora|ajenti)",
    "targets": [
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block admin panel access attempts - migrated from Rack Attack"
  },
  {
    "id": "100019",
    "phase": 2,
    "pattern": "(?i)/(\\.env\\.|\\.(git|svn|hg|bzr)|CVS/|\\.htaccess|\\.htpasswd|web\\.config)",
    "targets": [
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block config and version control file access - migrated from Rack Attack"
  },
  {
    "id": "100020",
    "phase": 2,
    "pattern": "(?i)\\.(jsp|asp|aspx|cgi|pl|py|rb|sh|bat|cmd|exe|com|scr)$",
    "targets": [
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block suspicious file extensions - migrated from Rack Attack"
  },
  {
    "id": "100021",
    "phase": 2,
    "pattern": "(?i)\\.(conf|config|ini|cfg|properties|env|htaccess|htpasswd|sql|db|sqlite|mdb|bak|backup|dump|log|logs|out)$",
    "targets": [
      "URI"
    ],
    "severity": "CRITICAL",
    "action": "block",
    "score": 10,
    "description": "Block config, database and log file access - migrated from Rack Attack"
  },
  {
    "id": "100022",
    "phase": 2,
    "pattern": "(?i)\\.(zip|tar|gz|rar|7z|tmp|temp|swp|swo|orig|old|bak)$",
    "targets": [
      "URI"
    ],
    "severity": "HIGH",
    "action": "block",
    "score": 8,
    "description": "Block archive and temporary file access - migrated from Rack Attack"
  }
]
